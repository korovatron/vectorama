<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H5MT68XJY3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-H5MT68XJY3');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#16213e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Span the space, transform everything. Interactive linear algebra playground for vectors, matrices, and transformations in 2D & 3D.">
    <title>Vectorama | Good news, everyone!</title>
    <link rel="icon" type="image/png" href="images/icon-192.png">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="images/icon-180.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Title Screen -->
    <div id="title-screen" class="title-screen">
        <div class="title-content">
            <img src="images/vectoramaLogo.png" alt="Vectorama Logo" class="title-logo" draggable="false">
            <p class="title-tagline">Good news, everyone! Vectors!</p>
            <p class="wip-notice">⚠️ Work in Progress<br>Expect frequent changes and bugs</p>
            <button id="start-btn" class="start-btn">Start</button>
            <p class="copyright">© 2026 Neil Kendall<span class="break-mobile"><br></span><span class="space-desktop">. </span><span class="projects-text">More @ </span><a href="https://www.korovatron.co.uk/" target="_blank">www.korovatron.co.uk</a></p>
        </div>
    </div>
    
    <!-- Main App Container (hidden until Start is clicked) -->
    <div id="main-app" class="main-app" style="display: none;">
    <!-- Hamburger Menu Button -->
    <button id="panel-toggle-btn" class="panel-toggle-btn active">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel">
            <img src="images/panelLogo.png" alt="Vectorama" class="panel-logo" draggable="false">
            
            <!-- Top Button Row -->
            <div class="top-button-row">
                <!-- Split Button: Add with Dropdown -->
                <div class="split-button-container">
                    <button id="add-main-btn" class="split-button-main">
                        <span style="font-size: 16px;">+</span>&nbsp;Add
                    </button>
                    <button id="add-dropdown-toggle" class="split-button-dropdown" title="Show examples">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="2,4 6,8 10,4"></polyline>
                        </svg>
                    </button>
                </div>
                
                <!-- Add Dropdown Menu (hidden by default) -->
                <div id="add-dropdown" class="add-dropdown" style="display: none;">
                    <div class="dropdown-item" data-action="add-vector">
                        <strong>+</strong> Add Vector
                    </div>
                    <div class="dropdown-item" data-action="add-matrix">
                        <strong>+</strong> Add Matrix
                    </div>
                    <div class="dropdown-item" data-action="add-line">
                        <strong>+</strong> Add Line
                    </div>
                    <div class="dropdown-item" data-action="add-plane">
                        <strong>+</strong> Add Plane
                    </div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-header">Transformations</div>
                    <div class="dropdown-item" data-action="rotation-45">
                        Rotation 45°
                    </div>
                    <div class="dropdown-item" data-action="rotation-90">
                        Rotation 90°
                    </div>
                    <div class="dropdown-item" data-action="scale-2x">
                        Scale 2×
                    </div>
                    <div class="dropdown-item" data-action="shear-x">
                        Shear X
                    </div>
                    <div class="dropdown-item" data-action="reflection-x">
                        Reflection X
                    </div>
                    <div class="dropdown-item" data-action="reflection-y">
                        Reflection Y
                    </div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-header">Vector Presets</div>
                    <!-- 2D Presets -->
                    <div class="dropdown-item preset-2d" data-action="preset-square">
                        Unit Square
                    </div>
                    <div class="dropdown-item preset-2d" data-action="preset-triangle">
                        Triangle
                    </div>
                    <div class="dropdown-item preset-2d" data-action="preset-pentagon">
                        Pentagon
                    </div>
                    <div class="dropdown-item preset-2d" data-action="preset-star">
                        Star
                    </div>
                    <div class="dropdown-item preset-2d" data-action="preset-circle">
                        Circle
                    </div>
                    <!-- 3D Presets -->
                    <div class="dropdown-item preset-3d" data-action="preset-cube" style="display: none;">
                        Unit Cube
                    </div>
                    <div class="dropdown-item preset-3d" data-action="preset-tetrahedron" style="display: none;">
                        Tetrahedron
                    </div>
                    <div class="dropdown-item preset-3d" data-action="preset-octahedron" style="display: none;">
                        Octahedron
                    </div>
                    <div class="dropdown-item preset-3d" data-action="preset-sphere" style="display: none;">
                        Sphere
                    </div>
                </div>
                
                <button id="reset-axes-btn" class="top-btn" title="Reset View">
                    RESET<br>AXES
                </button>
                
                <button id="grid-toggle-btn" class="top-btn" title="Toggle Grid">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <svg class="grid-icon" id="grid-off" width="16" height="16" viewBox="0 0 16 16">
                            <!-- Empty square -->
                            <rect x="2" y="2" width="12" height="12" fill="none" stroke="currentColor" stroke-width="1.5" />
                        </svg>
                        <span class="grid-separator">|</span>
                        <svg class="grid-icon grid-active" id="grid-on" width="16" height="16" viewBox="0 0 16 16">
                            <!-- 3x3 grid -->
                            <rect x="2" y="2" width="12" height="12" fill="none" stroke="currentColor" stroke-width="1.5" />
                            <line x1="6" y1="2" x2="6" y2="14" stroke="currentColor" stroke-width="1" />
                            <line x1="10" y1="2" x2="10" y2="14" stroke="currentColor" stroke-width="1" />
                            <line x1="2" y1="6" x2="14" y2="6" stroke="currentColor" stroke-width="1" />
                            <line x1="2" y1="10" x2="14" y2="10" stroke="currentColor" stroke-width="1" />
                        </svg>
                    </div>
                </button>
            </div>
            
            <!-- Second Button Row -->
            <div class="top-button-row">
                
                <button id="invariant-toggle-btn" class="top-btn" title="Cycle Invariant Display">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                        <span style="color: #ffffff; font-size: 9px;">Invariant</span>
                        <div style="display: flex; font-size: 9px;">
                            <span class="inv-option inv-active" id="inv-off">Off</span>
                            <span class="inv-separator">|</span>
                            <span class="inv-option" id="inv-pulse">Pulse</span>
                            <span class="inv-separator">|</span>
                            <span class="inv-option" id="inv-solid">Solid</span>
                        </div>
                    </div>
                </button>
                
                <button id="vector-display-toggle-btn" class="top-btn" title="Cycle Vector Display Mode">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 3px;">
                        <span style="color: #ffffff; font-size: 9px;">Vectors</span>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <svg class="vec-icon" id="vec-arrow" width="16" height="16" viewBox="0 0 16 16">
                                <defs>
                                    <marker id="arrowhead" markerWidth="4" markerHeight="4" refX="3" refY="2" orient="auto">
                                        <polygon points="0 0, 4 2, 0 4" fill="currentColor" />
                                    </marker>
                                </defs>
                                <line x1="2" y1="8" x2="12" y2="8" stroke="currentColor" stroke-width="1.5" marker-end="url(#arrowhead)" />
                            </svg>
                            <svg class="vec-icon vec-active" id="vec-point" width="16" height="16" viewBox="0 0 16 16">
                                <circle cx="8" cy="8" r="3" fill="currentColor" />
                            </svg>
                            <svg class="vec-icon" id="vec-path" width="16" height="16" viewBox="0 0 16 16">
                                <line x1="2" y1="11" x2="8" y2="8" stroke="currentColor" stroke-width="1.5" />
                                <line x1="8" y1="8" x2="14" y2="5" stroke="currentColor" stroke-width="1.5" />
                                <circle cx="2" cy="11" r="2" fill="currentColor" />
                                <circle cx="8" cy="8" r="2" fill="currentColor" />
                                <circle cx="14" cy="5" r="2" fill="currentColor" />
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button id="dimension-toggle-btn" class="top-btn" title="Toggle 2D/3D">
                    <span class="dim-option dim-active" id="dim-2d">2D</span>
                    <span class="dim-separator">|</span>
                    <span class="dim-option" id="dim-3d">3D</span>
                </button>
            </div>
            
            <!-- Third Button Row -->
            <div class="top-button-row">
                <button id="theme-toggle" class="top-btn" title="Toggle Theme">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <svg id="light-icon" class="theme-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <span class="theme-separator">|</span>
                        <svg id="dark-icon" class="theme-icon theme-active" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </div>
                </button>
            </div>
            
            <!-- Separator -->
            <div class="panel-separator"></div>

            <!-- Objects List (unified: matrices, planes, lines, vectors) -->
            <div id="objects-container">
                <!-- Apply Transformation button and all objects will be added here dynamically -->
            </div>
            
            <!-- Separator -->
            <div class="panel-separator"></div>

            <!-- Transform Mode Content -->
            <div id="transform-mode-content" class="mode-content">
            </div>
        </div>

        <!-- 3D Canvas -->
        <div class="canvas-container">
            <canvas id="three-canvas"></canvas>
            
            <!-- Eigenvalue Info Panel (bottom-right) -->
            <div id="eigenvalue-panel" class="eigenvalue-panel" style="display: none;">
                <div class="eigenvalue-content">
                    <div class="eigenvalue-row eigenvalue-header">
                        <span>Eigenvalues</span>
                    </div>
                    <div id="eigenvalue-values" class="eigenvalue-values"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    </div><!-- End Main App Container -->
    
    <script type="module" src="app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
